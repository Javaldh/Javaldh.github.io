<h1>http总结</ h1>
<br>
<b>一、HTTP的不足</b><br>HTTP协议经过多年的使用，发现了一些不足，主要是性能方面的，包括：<ul><li>HTTP的连接问题，HTTP客户端和服务器之间的交互是采用请求/应答模式，在客户端请求时，会建立一个HTTP连接，然后发送请求消息，服务端给出应答消息，然后连接就关闭了。（后来的HTTP1.1支持持久连接）</li><li>因为TCP连接的建立过程是有开销的，如果使用了SSL/TLS开销就更大。<br></li><li>在浏览器里，一个网页包含许多资源，包括HTML，CSS，JavaScript，图片等等，这样在加载一个网页时要同时打开连接到同一服务器的多个连接。<br></li><li>HTTP消息头问题，现在的客户端会发送大量的HTTP消息头，由于一个网页可能需要50-100个请求，就会有相当大的消息头的数据量。<br></li><li>HTTP通信方式问题，HTTP的请求/应答方式的会话都是客户端发起的，缺乏服务器通知客户端的机制，在需要通知的场景，如聊天室，游戏，客户端应用需要不断地轮询服务器。<br></li></ul><br><p>而SPDY和WebSocket是从不同的角度来解决这些不足中的一部分。除了这两个技术，还有其他技术也在针对这些不足提出改进。</p><b>二、SPDY</b><br>SPDY的主要目的是减少50%以上的页面加载时间，但是呢不增加部署的复杂性，不影响客户端和服务端的Web应用，只需要浏览器和Web服务器支持SPDY。主要有以下几点：<ul><li>多路复用，一个TCP连接上同时跑多个HTTP请求。请求可设定优先级。</li><li>去除不需要的HTTP头，压缩HTTP头，以减少需要的网络带宽。</li><li>使用了SSL作为传输协议提供数据安全。<br></li><li>对传输的数据使用gzip进行压缩</li><li>提供服务方发起通信，并向客户端推送数据的机制。</li></ul><p>实质上，SPDY就是想不影响HTTP语义的情况下，替换HTTP底层传输的协议来加快页面加载时间。</p><p>SPDY的解决办法就是设计了一个会话层协议--帧协议，解决多路复用，优先级等问题，然后在其上实现了HTTP的语义。</p><p><b>三、WebSocket</b><br>WebSocket则提供使用一个TCP连接进行双向通讯的机制，包括网络协议和API，以取代网页和服务器采用HTTP轮询进行双向通讯的机制。</p><p>本质上来说，WebSocket是不限于HTTP协议的，但是由于现存大量的HTTP基础设施，代理，过滤，身份认证等等，WebSocket借用HTTP和HTTPS的端口。</p><p>由于使用HTTP的端口，因此TCP连接建立后的握手消息是基于HTTP的，由服务器判断这是一个HTTP协议，还是WebSocket协议。 WebSocket连接除了建立和关闭时的握手，数据传输和HTTP没丁点关系了。</p><p>WebSocket也有自己一套帧协议。</p><b>四、SPDY和WebSocket的关系</b><br>SPDY和WebSocket的关系比较复杂。<br><ol><li>补充关系，二者侧重点不同。SPDY更侧重于给Web页面的加载提速，而WebSocket更强调为Web应用提供一种双向的通讯机制以及API。</li><li>竞争关系，二者解决的问题有交集，比如在服务器推送上SPDY和WebSocket都提供了方案。</li><li>承载关系，试想，如果SPDY的标准化早于WebSocket，WebSocket完全可以侧重于API，利用SPDY的帧机制和多路复用机制实现该API。 Google提出草案，说WebSocket可以跑在SPDY之上。WebSocket的连接建立在SPDY的流之上，将WebSocket的帧映射到SPDY的帧上。</li><li>融合关系，如微软在HTTP Speed+Mobility中所做的。</li></ol><br><p><b>五、题外话</b><br><b>1. HTTP Speed+Mobility </b><br>还有一个有趣的技术叫做HTTP Speed+Mobility，和SPDY一样都是HTTP 2.0标准的竞争者，HTTP Speed+Mobility来自微软。HTTP SM借鉴了SPDY和WebSocket的协议，将二者揉为一体，又有所取舍。</p>HTTP SM的设计原则包括：<ul><li>保留HTTP的语义，这一点和SPDY一致，但也正应如此，抛弃了SPDY里的ServerPush。</li><li>遵守分层的网络架构，TCP能做的，HTTP SM不做，因此去除了SPDY的流控。</li><li>使用现有标准，因此使用HTTP/1.1 Upgrade header机制，借用了WebSocket的握手机制和帧格式（RFC6455）。</li><li>客户端掌握内容的控制，因此不强制使用压缩和SSL/TLS。</li><li>考虑到网络的费用和电力，这点考虑到了移动设备以及物联网，提供了Credit Control机制。</li></ul><br>HTTP SM分以下几层：<ul><li>会话层和帧协议，这部分取自WebSocket协议。包括握手机制，以及帧格式。</li><li>流层（包括多路复用），这部分主要借鉴SPDY，包括多路复用，流优先级，但增加了Credit Control。这部分作为 WebSocket协议的扩展。</li><li>HTTP层，在流层上实现HTTP语义，这部分也借鉴自SPDY。</li></ul><b>2.  Network-Friendly HTTP</b><br>NF是HTTP 2.0候选方案之一，主要提出以下改进：<ul><li>对HTTP头的名称进行二进制编码</li><li>对通用HTTP头进行分组</li><li>请求/应答的多路复用</li><li>分层模型</li></ul><p>NF同样定义了帧和流，</p><p><b>3. WAKA</b><br>WAKA也是HTTP 2.0候选方案之一，是HTTP协议原作者Roy Fielding提出的一个提案。</p>WAKA支持多路复用，支持优先级。WAKA提出了两个新的HTTP方法，RENDER和MONITOR。
